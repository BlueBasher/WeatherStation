var map=function(){var e=null,t=null;return initialize=function(){function i(t){e.setView({zoom:5,center:t.center})}try{e=new Microsoft.Maps.Map(document.getElementById("map"),{credentials:"Av2PLmIc83vU7x36uz7GOlJ8nEJlkCEuMDVIowwbr-qMO8wDT1_9jloSFa_xpbJQ",mapTypeId:Microsoft.Maps.MapTypeId.road}),t=new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0,0),{visible:!1}),Microsoft.Maps.Events.addHandler(e,"viewchange",hideInfobox),e.entities.push(t);var o=new Microsoft.Maps.GeoLocationProvider(e);o.getCurrentPosition({successCallback:i}),$.getJSON("api/values",null,function(t){$.each(t,function(t,i){var o=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(i.Latitude,i.Longitude));o.deviceId=i.DeviceId,o.temperature=i.Temperature,o.setOptions({visible:!0}),Microsoft.Maps.Events.addHandler(o,"click",displayInfobox),e.entities.push(o)})})}catch(n){alert(n.message)}},displayInfobox=function(e){t.setOptions({offset:new Microsoft.Maps.Point(0,25),visible:!0}),t.setLocation(e.target.getLocation());var i='<div id="infoboxText"';i+='style="background-color:White; border-style:solid;border-width:medium; border-color:DarkOrange; min-height:100px; ',i+='position:absolute;top:0px; left:23px; width:240px;">',i+='<b id="infoboxTitle" style="position:absolute; top:10px; left:10px; width:220px;">',i=i+e.target.deviceId+"</b>",i+='<a id="infoboxDescription" style="position:absolute; top:30px; left:10px; width:220px;">',i=i+e.target.temperature+" deg C</a></div>",t.setHtmlContent(i)},hideInfobox=function(e){t.setOptions({visible:!1})},{initialize:initialize}}();